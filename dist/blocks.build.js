!function(e){function t(a){if(n[a])return n[a].exports;var o=n[a]={i:a,l:!1,exports:{}};return e[a].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};t.m=e,t.c=n,t.d=function(e,n,a){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:a})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n(1)},function(e,t,n){"use strict";var a=n(2),o=(n.n(a),n(3)),r=(n.n(o),n(4)),l=n(5),s=n(6),__=wp.i18n.__;(0,wp.blocks.registerBlockType)("cgb/kona-instagram-for-gutenberg",{title:__("Kona: Instagram for Gutenberg"),icon:s.a.instagram,category:"common",keywords:[__("kona"),__("instagram")],attributes:r.a,supports:{align:["wide","full"]},edit:l.a,save:function(e){return e.attributes,e.className,null}})},function(e,t){},function(e,t){},function(e,t,n){"use strict";n.d(t,"a",function(){return a});var a={token:{type:"string",default:""},displayType:{type:"string",default:"grid"},numberCols:{type:"number",default:4},numberImages:{type:"number",default:4},hasEqualImages:{type:"boolean",default:!1},thumbs:{type:"array",default:[]},gridGap:{type:"number",default:0},showProfile:{type:"boolean",default:!1},profile:{type:"array",default:[]},backgroundColor:{type:"string",default:"transparent"},showCaptions:{type:"boolean",default:!1}}},function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function r(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),s=wp.element,i=s.Component,p=s.Fragment,u=wp.editor,c=u.InspectorControls,m=u.PanelColorSettings,g=wp.components,f=g.PanelBody,d=g.PanelRow,h=g.RangeControl,w=g.TextControl,b=g.ToggleControl,C=g.Spinner,__=wp.i18n.__,y=function(e){function t(){var e,n,r,l;a(this,t);for(var s=arguments.length,i=Array(s),p=0;p<s;p++)i[p]=arguments[p];return n=r=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),r.state={loading:!0,apiResponseCode:200,apiErrorMessage:""},r.onChangeToken=function(e){r.props.setAttributes({token:e}),r.fetchPhotos(r.props.attributes.numberImages,e)},r.onChangeImages=function(e){r.props.setAttributes({numberImages:e}),r.fetchPhotos(e)},r.onChangeShowProfile=function(e){r.props.setAttributes({showProfile:e}),r.fetchBio()},r.renderImage=function(e){var t=r.props.attributes,n=t.hasEqualImages,a=t.backgroundColor,o=t.showCaptions;if(e.media_type,!0)return wp.element.createElement("div",{className:"kona-image-wrapper "+(n?"has-equal-images":""),style:{backgroundColor:a},key:e.id},wp.element.createElement("img",{className:"kona-image",src:e.media_url,alt:e.caption?e.caption:""}),wp.element.createElement("div",{className:"kona-image-overlay"},o&&wp.element.createElement("div",{className:"kona-image-caption"},wp.element.createElement("span",{className:"kona-image-caption_text"},e.caption),wp.element.createElement("span",{className:"kona-image-caption_likes"}))))},l=n,o(r,l)}return r(t,e),l(t,[{key:"componentDidMount",value:function(){this.fetchPhotos(),this.fetchBio()}},{key:"fetchPhotos",value:function(e,t){var n=this,a=(e||this.props.attributes.numberImages,t||this.props.attributes.token);return!!a&&fetch("https://graph.instagram.com/me/media?fields=id,caption,media_type,media_url,permalink,thumbnail_url,timestamp,username&access_token="+a).then(function(e){return e.json()}).then(function(e){console.log(e),e.data&&(n.setState({apiResponseCode:200,loading:!1}),e.data.length>0?n.props.setAttributes({thumbs:e.data}):(n.props.setAttributes({thumbs:[]}),n.setState({apiResponseCode:500})))})}},{key:"fetchBio",value:function(){var e=this,t=this.props.attributes.token;return!!t&&fetch("https://graph.instagram.com/me?fields=id,username&access_token="+t).then(function(e){return e.json()}).then(function(t){t.meta&&200===t.meta.code?e.props.setAttributes({profile:t.data}):e.props.setAttributes({profile:[]})})}},{key:"render",value:function(){var e=this,t=this.props,n=t.attributes,a=n.token,o=n.numberCols,r=n.numberImages,l=n.hasEqualImages,s=n.thumbs,i=n.gridGap,u=(n.showProfile,n.profile,n.backgroundColor),g=n.showCaptions,y=t.className,k=t.setAttributes,v=this.state,E=v.apiResponseCode,_=v.apiErrorMessage,I=v.loading,x=void 0;x=a&&200===E?I?wp.element.createElement("p",{className:y},wp.element.createElement(C,null),__("Loading feed")):wp.element.createElement("div",{className:"display-grid kona-grid",style:{gridTemplateColumns:"repeat("+o+", 1fr)",marginLeft:"-"+i+"px",marginRight:"-"+i+"px",gridGap:i+"px"}},s&&s.slice(0,r).map(function(t){return e.renderImage(t)})):200!==E?wp.element.createElement("div",null,"\ud83e\udd26\ud83c\udffb\u200d\u2640\ufe0f Ooops something went wrong: ",_," \ud83e\udd26\ud83c\udffb\u200d\u2642\ufe0f"):wp.element.createElement("div",{className:y},wp.element.createElement("p",null,"To get started please add an Instagram Access Token."," "),wp.element.createElement("p",null,"To do this we suggest installing the Feed Them Social plugin by Slick Remix, ",wp.element.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://www.slickremix.com/docs/how-to-create-instagram-access-token/"},"then following these steps.")),wp.element.createElement("p",null,"Once you have a token, please paste it into the 'Instagram Access Token' setting."),wp.element.createElement("p",null,"You can then deactivate the FTS plugin if needed."));var P=void 0;return P=wp.element.createElement(p,null),wp.element.createElement("div",{className:y},wp.element.createElement(c,null,wp.element.createElement(f,{title:__("Step 1: Access Tokens")},wp.element.createElement(w,{label:__("Instagram Access Token"),value:a,onChange:this.onChangeToken})),wp.element.createElement(f,{title:__("Step 2: Layout Options")},wp.element.createElement(h,{value:o,onChange:function(e){return k({numberCols:e})},min:1,max:6,step:1,label:__("Columns")}),wp.element.createElement(d,null,"Note: Videos will be skipped in the total image count (these will be added in future plugin versions)"),wp.element.createElement(d,null,wp.element.createElement(h,{value:r,onChange:this.onChangeImages,min:1,max:20,step:1,allowReset:"true",label:__("Images")})),wp.element.createElement(d,null,wp.element.createElement(h,{value:i,onChange:function(e){return k({gridGap:e})},min:0,max:20,step:1,label:__("Image spacing (px)")})),wp.element.createElement(b,{label:__("Show captions?"),checked:g,help:__("Show image captions on hover?"),onChange:function(e){return k({showCaptions:e})}}),wp.element.createElement(b,{label:__("Show equal sized images?"),checked:l,help:__("Use square thumbnails for each image?"),onChange:function(e){return k({hasEqualImages:e})}}),wp.element.createElement(m,{title:__("Image Background"),colorSettings:[{value:u,onChange:function(e){return k({backgroundColor:e})},label:__("Background Color")}]}))),P,x)}}]),t}(i);t.a=y},function(e,t,n){"use strict";var a={};a.instagram=wp.element.createElement("svg",{width:"20",height:"20",viewBox:"0 0 20 20",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},wp.element.createElement("defs",null),wp.element.createElement("g",{id:"Page-1",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},wp.element.createElement("g",{id:"icon",fill:"#1D1D1B",fillRule:"nonzero"},wp.element.createElement("path",{d:"M6.01939477,1.65061898 C3.61045392,1.65061898 1.65061898,3.61045392 1.65061898,6.01939477 L1.65061898,13.9806052 C1.65061898,16.3895736 3.61045392,18.349381 6.01939477,18.349381 L13.9806052,18.349381 C16.3895736,18.349381 18.349381,16.3895736 18.349381,13.9806052 L18.349381,6.01939477 C18.349381,3.61045392 16.3895736,1.65061898 13.9806052,1.65061898 L6.01939477,1.65061898 Z M13.9806052,20 L6.01939477,20 C4.41155433,20 2.89994498,19.3738652 1.76302613,18.2368638 C0.626134801,17.100055 0,15.5884732 0,13.9806052 L0,6.01939477 C0,4.41155433 0.626134801,2.89994498 1.76302613,1.76302613 C2.89994498,0.626134801 4.41155433,0 6.01939477,0 L13.9806052,0 C15.5884732,0 17.100055,0.626134801 18.2368638,1.76302613 C19.3738652,2.89994498 20,4.41155433 20,6.01939477 L20,13.9806052 C20,15.5884732 19.3738652,17.100055 18.2368638,18.2368638 C17.100055,19.3738652 15.5884732,20 13.9806052,20 Z",id:"Fill-3"}),wp.element.createElement("path",{d:"M10,6.5474553 C8.0962586,6.5474553 6.5474553,8.0962586 6.5474553,10 C6.5474553,11.9037414 8.0962586,13.4525447 10,13.4525447 C11.9037414,13.4525447 13.4525447,11.9037414 13.4525447,10 C13.4525447,8.0962586 11.9037414,6.5474553 10,6.5474553 Z M10,15.1031637 C7.18610729,15.1031637 4.89683631,12.8138927 4.89683631,10 C4.89683631,7.18610729 7.18610729,4.89683631 10,4.89683631 C12.8138927,4.89683631 15.1031637,7.18610729 15.1031637,10 C15.1031637,12.8138927 12.8138927,15.1031637 10,15.1031637 Z",id:"Fill-4"}),wp.element.createElement("path",{d:"M16.2379642,4.74209078 C16.2379642,5.28335626 15.7991747,5.7221458 15.2579092,5.7221458 C14.7166437,5.7221458 14.2778542,5.28335626 14.2778542,4.74209078 C14.2778542,4.20082531 14.7166437,3.76203576 15.2579092,3.76203576 C15.7991747,3.76203576 16.2379642,4.20082531 16.2379642,4.74209078",id:"Fill-5"})))),t.a=a}]);